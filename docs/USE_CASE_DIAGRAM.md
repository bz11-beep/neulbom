# 늘봄 유스케이스 다이어그램

## 문서 정보

| 항목 | 내용 |
|------|------|
| 프로젝트명 | 늘봄 (AI 기반 노인 돌봄 음성 분석 시스템) |
| 문서 버전 | 1.0 |
| 작성일 | 2026-02-09 |
| 개발 기간 | 2025년 12월 ~ 2026년 2월 (2025.12.05 ~ 2026.02.10) |
| 개발 인원 | 5명 (최선임 총괄기획, 지태민 프론트엔드, 김승민 백엔드, 최대영 DB/IoT, 조민솔 기획/문서) |

---

## 목차

1. [액터 정의](#1-액터-정의)
2. [전체 시스템 경계 다이어그램](#2-전체-시스템-경계-다이어그램)
3. [서브시스템별 유스케이스 다이어그램](#3-서브시스템별-유스케이스-다이어그램)
   - 3.1 인증 서브시스템
   - 3.2 음성 분석 서브시스템
   - 3.3 AI 대화 서브시스템
   - 3.4 모니터링 서브시스템
   - 3.5 디바이스 관리 서브시스템
   - 3.6 알림 서브시스템
4. [액터별 접근 가능 기능 매트릭스](#4-액터별-접근-가능-기능-매트릭스)
5. [유스케이스 관계 정의](#5-유스케이스-관계-정의)

---

## 1. 액터 정의

### 1.1 액터 목록

| 액터 | 영문명 | 유형 | 설명 |
|------|--------|------|------|
| 비회원 | Guest | 기본 액터 (Primary) | 시스템에 로그인하지 않은 사용자. 회원가입과 로그인만 수행 가능 |
| 보호자 | Guardian | 주요 액터 (Primary) | 어르신을 돌보는 가족 또는 요양사. 로그인 후 대시보드, 리포트, 디바이스 관리, 알림 확인, 프로필 관리 수행 |
| 어르신 | Senior | 주요 액터 (Primary) | 돌봄 대상 고령자. AI 대화 도우미 '보미'와 음성 대화를 통해 시스템과 상호작용 |
| AI 시스템 | AI System | 시스템 액터 (System) | STT(faster-whisper), 감정 분석(KcELECTRA+Wav2Vec2), LLM 대화 생성(GPT-4o-mini), TTS(Edge TTS)를 수행하는 백엔드 AI 파이프라인 |

### 1.2 액터 계층 구조

```
                        ┌──────────────┐
                        │    사용자     │
                        │   (User)     │
                        └──────┬───────┘
                               │
              ┌────────────────┼────────────────┐
              │                │                │
        ┌─────▼─────┐   ┌─────▼─────┐   ┌──────▼─────┐
        │   비회원   │   │   보호자   │   │   어르신   │
        │  (Guest)  │   │(Guardian) │   │ (Senior)  │
        └───────────┘   └───────────┘   └────────────┘
                               │                │
                               │  관리/모니터링  │  음성 대화
                               ▼                ▼
                        ┌──────────────────────────┐
                        │       AI 시스템           │
                        │     (AI System)          │
                        │                          │
                        │  ┌─────┐  ┌───────────┐  │
                        │  │ STT │  │ 감정 분석  │  │
                        │  └─────┘  └───────────┘  │
                        │  ┌─────┐  ┌───────────┐  │
                        │  │ TTS │  │ LLM 대화  │  │
                        │  └─────┘  └───────────┘  │
                        └──────────────────────────┘
```

### 1.3 액터 간 관계

| 관계 | 설명 |
|------|------|
| 비회원 -> 보호자 | 회원가입 후 로그인하면 보호자 액터로 전환 |
| 보호자 -> 어르신 | 보호자 1명당 어르신 1명이 연결됨 (tb_guardian -> tb_senior FK 관계) |
| 어르신 -> AI 시스템 | 어르신의 음성 입력이 AI 파이프라인을 트리거 |
| AI 시스템 -> 보호자 | AI 분석 결과(감정, 점수, 알림)가 보호자 대시보드에 전달 |

---

## 2. 전체 시스템 경계 다이어그램

```
┌─────────┐                                                                    ┌─────────┐
│         │                                                                    │         │
│ 비회원   │                                                                    │ 어르신   │
│ (Guest) │                                                                    │(Senior) │
│         │                                                                    │         │
└────┬────┘                                                                    └────┬────┘
     │                                                                              │
     │          ┌──────────────────────────────────────────────────────────┐         │
     │          │                  늘봄 시스템 (System Boundary)            │         │
     │          │                                                          │         │
     │          │  ┌──────────────────────┐  ┌───────────────────────────┐ │         │
     ├──────────┼─>│  [인증 서브시스템]     │  │  [음성 분석 서브시스템]    │<┼─────────┤
     │          │  │                      │  │                           │ │         │
     │          │  │  UC-01 회원가입       │  │  UC-06 음성 녹음          │ │         │
     │          │  │  UC-02 로그인        │  │  UC-07 STT 변환          │ │         │
     │          │  │  UC-03 비밀번호 변경  │  │  UC-08 감정 분석          │ │         │
     │          │  │  UC-04 아이디 중복확인│  │  UC-09 음성 점수 산출     │ │         │
     │          │  └──────────────────────┘  └───────────────────────────┘ │         │
     │          │                                                          │         │
     │          │  ┌──────────────────────┐  ┌───────────────────────────┐ │         │
     │          │  │  [AI 대화 서브시스템]  │  │  [모니터링 서브시스템]     │ │         │
     │          │  │                      │  │                           │ │         │
     │          │  │  UC-10 Q&A 매칭      │  │  UC-13 대시보드 조회      │ │         │
     │          │  │  UC-11 LLM 대화 생성 │  │  UC-14 일간 리포트        │ │         │
     │          │  │  UC-12 TTS 응답 생성 │  │  UC-15 주간 리포트        │ │         │
     │          │  │                      │  │  UC-16 월간 리포트        │ │         │
     │          │  └──────────────────────┘  └───────────────────────────┘ │         │
     │          │                                                          │         │
     │          │  ┌──────────────────────┐  ┌───────────────────────────┐ │         │
     │          │  │  [디바이스 관리       │  │  [알림 서브시스템]         │ │         │
     │          │  │   서브시스템]         │  │                           │ │         │
     │          │  │                      │  │  UC-20 알림 생성          │ │         │
     │          │  │  UC-17 디바이스 등록  │  │  UC-21 알림 확인          │ │         │
     │          │  │  UC-18 센서 확인     │  │  UC-22 알림 읽음 처리     │ │         │
     │          │  │  UC-19 음성세션 생성  │  │                           │ │         │
     │          │  └──────────────────────┘  └───────────────────────────┘ │         │
     │          │                                                          │         │
     │          └──────────────────────────────────────────────────────────┘         │
     │                        ▲                              ▲                       │
     │                        │                              │                       │
┌────▼────┐              ┌────┴──────┐                ┌──────┴──────┐          ┌─────▼─────┐
│         │              │           │                │             │          │           │
│ 비회원   │              │  보호자    │                │  AI 시스템   │          │  어르신    │
│ (Guest) │              │(Guardian) │                │ (AI System) │          │ (Senior)  │
│         │              │           │                │             │          │           │
└─────────┘              └───────────┘                └─────────────┘          └───────────┘
```

---

## 3. 서브시스템별 유스케이스 다이어그램

### 3.1 인증 서브시스템

**관련 API**: `/api/signup`, `/api/login`, `/api/check-duplicate`, `/api/change-password`

```
┌─────────┐         ┌─────────────────────────────────────────────────┐
│         │         │            인증 서브시스템 (Authentication)       │
│ 비회원   │         │                                                 │
│ (Guest) ├────────>│  ┌─────────────────────────────────────────┐    │
│         │         │  │  UC-01 회원가입                          │    │
│         │         │  │  (POST /api/signup)                     │    │
│         │         │  │                                         │    │
│         │         │  │  ......<<include>>...... UC-04 아이디    │    │
│         │         │  │                          중복 확인      │    │
│         │         │  │                  (POST /api/check-      │    │
│         │         │  │                   duplicate)            │    │
│         │         │  └─────────────────────────────────────────┘    │
│         │         │                                                 │
│         ├────────>│  ┌─────────────────────────────────────────┐    │
│         │         │  │  UC-02 로그인                            │    │
└─────────┘         │  │  (POST /api/login)                      │    │
                    │  └─────────────────────────────────────────┘    │
┌─────────┐         │                                                 │
│         │         │                                                 │
│ 보호자   ├────────>│  ┌─────────────────────────────────────────┐    │
│(Guard-  │         │  │  UC-02 로그인                            │    │
│ ian)    │         │  │  (POST /api/login)                      │    │
│         │         │  └─────────────────────────────────────────┘    │
│         │         │                                                 │
│         ├────────>│  ┌─────────────────────────────────────────┐    │
│         │         │  │  UC-03 비밀번호 변경                      │    │
│         │         │  │  (POST /api/change-password)             │    │
│         │         │  └─────────────────────────────────────────┘    │
│         │         │                                                 │
└─────────┘         └─────────────────────────────────────────────────┘
```

**유스케이스 설명**:

| UC ID | 유스케이스명 | 액터 | 사전조건 | 사후조건 |
|-------|------------|------|---------|---------|
| UC-01 | 회원가입 | 비회원 | 회원가입 페이지에 접근한 상태 | tb_guardian + tb_senior 레코드 생성 |
| UC-02 | 로그인 | 비회원, 보호자 | 가입 완료 상태 | 세션 생성, 대시보드로 이동 |
| UC-03 | 비밀번호 변경 | 보호자 | 로그인된 상태 | 비밀번호 업데이트 |
| UC-04 | 아이디 중복 확인 | 비회원 | 회원가입 폼에서 아이디 입력 상태 | 중복 여부 반환 |

---

### 3.2 음성 분석 서브시스템

**관련 API**: `/api/analyze` (SSE), `/api/create-voice-session`

```
┌─────────┐         ┌─────────────────────────────────────────────────┐
│         │         │          음성 분석 서브시스템 (Voice Analysis)    │
│ 어르신   │         │                                                 │
│(Senior) ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-06 음성 녹음                     │        │
│         │         │  │  (MediaRecorder API -> 서버 전송)    │        │
│         │         │  │                                     │        │
│         │         │  │  ........<<include>>........         │        │
│         │         │  │  │                        │         │        │
│         │         │  │  ▼                        ▼         │        │
│         │         │  │  UC-07 STT 변환     UC-09 음성 점수 │        │
│         │         │  │  (faster-whisper     산출 (8차원)   │        │
│         │         │  │   tiny, int8)                       │        │
│         │         │  │                                     │        │
│         │         │  │  ........<<include>>........         │        │
│         │         │  │  │                                  │        │
│         │         │  │  ▼                                  │        │
│         │         │  │  UC-08 감정 분석                     │        │
│         │         │  │  (KcELECTRA + Wav2Vec2              │        │
│         │         │  │   + YIN Pitch 앙상블)               │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
└─────────┘         │                                                 │
                    │                                                 │
┌─────────┐         │                                                 │
│ AI      │         │                                                 │
│ 시스템   ├────────>│  UC-07 STT 변환 (수행)                          │
│(AI Sys- │         │  UC-08 감정 분석 (수행)                          │
│ tem)    ├────────>│  UC-09 음성 점수 산출 (수행)                     │
│         │         │                                                 │
└─────────┘         └─────────────────────────────────────────────────┘
```

**유스케이스 설명**:

| UC ID | 유스케이스명 | 액터 | 사전조건 | 사후조건 |
|-------|------------|------|---------|---------|
| UC-06 | 음성 녹음 | 어르신 | 디바이스 등록 및 센서 활성 상태 | 음성 파일이 서버에 전송됨 |
| UC-07 | STT 변환 | AI 시스템 | 음성 파일 수신 완료 | 텍스트 변환 결과(text, WPM, duration, silence) |
| UC-08 | 감정 분석 | AI 시스템 | STT 텍스트 + 오디오 신호 확보 | 감정 레이블(6종) + 신뢰도 + Z-peak |
| UC-09 | 음성 점수 산출 | AI 시스템 | STT 결과 + 감정 결과 확보 | 8차원 점수 (0~100) + 종합 평균 |

---

### 3.3 AI 대화 서브시스템

**관련 API**: `/api/analyze` (Step 5~5.7), `/api/tts-audio/<filename>`

```
┌─────────┐         ┌─────────────────────────────────────────────────┐
│         │         │          AI 대화 서브시스템 (AI Conversation)    │
│ 어르신   │         │                                                 │
│(Senior) ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-10 Q&A 매칭                      │        │
│         │         │  │  (10카테고리, 44항목)                 │        │
│         │         │  │  정확일치 -> 부분일치 -> 키워드일치   │        │
│         │         │  │                                     │        │
│         │         │  │  ........<<extend>>..........        │        │
│         │         │  │  │ (매칭 실패 시)                    │        │
│         │         │  │  ▼                                  │        │
│         │         │  │  UC-11 LLM 대화 생성                 │        │
│         │         │  │  (GPT-4o-mini, 페르소나: 보미)       │        │
│         │         │  │  감정별 동적 프롬프트 적용            │        │
│         │         │  │                                     │        │
│         │         │  │  ........<<include>>........         │        │
│         │         │  │  │                                  │        │
│         │         │  │  ▼                                  │        │
│         │         │  │  UC-12 TTS 응답 생성                 │        │
│         │         │  │  (Edge TTS, ko-KR-SunHiNeural)      │        │
│         │         │  │  MP3 파일 생성 -> 음성 재생          │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
└─────────┘         │                                                 │
                    │                                                 │
┌─────────┐         │                                                 │
│ AI      │         │                                                 │
│ 시스템   ├────────>│  UC-10 Q&A 매칭 (수행)                          │
│(AI Sys- ├────────>│  UC-11 LLM 대화 생성 (수행)                     │
│ tem)    ├────────>│  UC-12 TTS 응답 생성 (수행)                     │
│         │         │                                                 │
└─────────┘         └─────────────────────────────────────────────────┘
```

**유스케이스 설명**:

| UC ID | 유스케이스명 | 액터 | 사전조건 | 사후조건 |
|-------|------------|------|---------|---------|
| UC-10 | Q&A 매칭 | AI 시스템 | STT 텍스트 확보 | 매칭 결과 (성공: 응답+감정, 실패: LLM 호출 필요) |
| UC-11 | LLM 대화 생성 | AI 시스템 | Q&A 매칭 실패 또는 자유 대화 필요 | GPT-4o-mini 기반 응답 텍스트 생성 |
| UC-12 | TTS 응답 생성 | AI 시스템 | AI 응답 텍스트 확보 | MP3 파일 생성 및 저장 (/tts_outputs/) |

---

### 3.4 모니터링 서브시스템

**관련 API**: `/api/activity-daily`, `/api/activity-weekly`, `/api/activity-monthly`

```
┌─────────┐         ┌─────────────────────────────────────────────────┐
│         │         │       모니터링 서브시스템 (Monitoring)            │
│ 보호자   │         │                                                 │
│(Guard-  │         │                                                 │
│ ian)    ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-13 대시보드 조회                  │        │
│         │         │  │  (/templates/dashboard.html)         │        │
│         │         │  │  감정 현황 + 활동 통계 + 기기 상태   │        │
│         │         │  │                                     │        │
│         │         │  │  ........<<extend>>..........        │        │
│         │         │  │  │          │           │           │        │
│         │         │  │  ▼          ▼           ▼           │        │
│         │         │  │  UC-14     UC-15       UC-16       │        │
│         │         │  │  일간      주간        월간         │        │
│         │         │  │  리포트    리포트      리포트        │        │
│         │         │  │(daily)   (weekly)    (monthly)     │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
│         ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-05 보호자/어르신 정보 수정        │        │
│         │         │  │  (/templates/mypage.html)            │        │
│         │         │  │  POST /api/update-guardian            │        │
│         │         │  │  POST /api/update-senior              │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
└─────────┘         └─────────────────────────────────────────────────┘
```

**유스케이스 설명**:

| UC ID | 유스케이스명 | 액터 | 사전조건 | 사후조건 |
|-------|------------|------|---------|---------|
| UC-13 | 대시보드 조회 | 보호자 | 로그인된 상태 | 감정/활동/기기 종합 현황 표시 |
| UC-14 | 일간 리포트 | 보호자 | 대시보드 접근 상태 | 오늘 활동량(모션 감지 횟수) 표시 |
| UC-15 | 주간 리포트 | 보호자 | 대시보드 접근 상태 | 최근 7일 일별 활동량 배열 반환 |
| UC-16 | 월간 리포트 | 보호자 | 대시보드 접근 상태 | 최근 4주 주별 활동량 배열 반환 |
| UC-05 | 정보 수정 | 보호자 | 로그인된 상태 | 보호자/어르신 정보 DB 업데이트 |

---

### 3.5 디바이스 관리 서브시스템

**관련 API**: `/api/add-device`, `/api/check-sensor`, `/api/create-voice-session`

```
┌─────────┐         ┌─────────────────────────────────────────────────┐
│         │         │    디바이스 관리 서브시스템 (Device Management)    │
│ 보호자   │         │                                                 │
│(Guard-  │         │                                                 │
│ ian)    ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-17 디바이스 등록                  │        │
│         │         │  │  (POST /api/add-device)              │        │
│         │         │  │  기기 정보 + 센서 자동 생성           │        │
│         │         │  │  (기기명 '환경' 포함시 env,          │        │
│         │         │  │   그 외 motion)                      │        │
│         │         │  │                                     │        │
│         │         │  │  ........<<include>>........         │        │
│         │         │  │  │                                  │        │
│         │         │  │  ▼                                  │        │
│         │         │  │  UC-18 센서 확인                     │        │
│         │         │  │  (POST/GET /api/check-sensor)       │        │
│         │         │  │  센서 유무 및 상태 확인              │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
│         ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-19 음성 세션 생성                 │        │
│         │         │  │  (POST /api/create-voice-session)    │        │
│         │         │  │  tb_sensing INSERT -> sensing_id 반환│        │
│         │         │  │                                     │        │
│         │         │  │  ........<<include>>........         │        │
│         │         │  │  │                                  │        │
│         │         │  │  ▼                                  │        │
│         │         │  │  UC-18 센서 확인 (사전 검증)         │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
└─────────┘         └─────────────────────────────────────────────────┘
```

**유스케이스 설명**:

| UC ID | 유스케이스명 | 액터 | 사전조건 | 사후조건 |
|-------|------------|------|---------|---------|
| UC-17 | 디바이스 등록 | 보호자 | 로그인 상태, 어르신 등록 완료 | tb_device + tb_sensor 레코드 생성 |
| UC-18 | 센서 확인 | 보호자 | 로그인 상태 | 센서 유무 및 상세 정보 반환 |
| UC-19 | 음성 세션 생성 | 보호자 | 센서 등록 완료 상태 | tb_sensing 레코드 생성, sensing_id 반환 |

---

### 3.6 알림 서브시스템

**관련 API**: `/api/check-alert`, `/api/alert-list`, `/api/alert-read-all`

```
┌─────────┐         ┌─────────────────────────────────────────────────┐
│         │         │           알림 서브시스템 (Alert)                │
│ 보호자   │         │                                                 │
│(Guard-  │         │                                                 │
│ ian)    ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-21 알림 확인                     │        │
│         │         │  │  (GET /api/check-alert)              │        │
│         │         │  │  미읽음 알림 1건 조회 (폴링 방식)     │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
│         ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-21-1 알림 목록 조회               │        │
│         │         │  │  (POST /api/alert-list)              │        │
│         │         │  │  최근 10건 알림 조회                  │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
│         ├────────>│  ┌─────────────────────────────────────┐        │
│         │         │  │  UC-22 알림 읽음 처리                 │        │
│         │         │  │  (POST /api/alert-read-all)          │        │
│         │         │  │  전체 알림 received_yes=1 업데이트    │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
└─────────┘         │                                                 │
                    │                                                 │
┌─────────┐         │                                                 │
│ AI      │         │  ┌─────────────────────────────────────┐        │
│ 시스템   ├────────>│  │  UC-20 알림 생성                     │        │
│(AI Sys- │         │  │  (음성 분석 중 위험 감지 시 자동)     │        │
│ tem)    │         │  │                                     │        │
│         │         │  │  트리거 조건:                        │        │
│         │         │  │  - 평균 점수 < 50 (고위험)           │        │
│         │         │  │  - 감정 점수 < 40 (감정 불안정)      │        │
│         │         │  │  - 부정 감정 (슬픔/분노/불안) 고신뢰 │        │
│         │         │  │                                     │        │
│         │         │  │  tb_alert INSERT                    │        │
│         │         │  └─────────────────────────────────────┘        │
│         │         │                                                 │
└─────────┘         └─────────────────────────────────────────────────┘
```

**유스케이스 설명**:

| UC ID | 유스케이스명 | 액터 | 사전조건 | 사후조건 |
|-------|------------|------|---------|---------|
| UC-20 | 알림 생성 | AI 시스템 | 음성 분석 완료 + 위험 감지 조건 충족 | tb_alert 레코드 생성 |
| UC-21 | 알림 확인 | 보호자 | 로그인된 상태 | 미읽음 알림 1건 표시 (프론트엔드 폴링) |
| UC-21-1 | 알림 목록 조회 | 보호자 | 로그인된 상태 | 최근 10건 알림 목록 표시 |
| UC-22 | 알림 읽음 처리 | 보호자 | 미읽음 알림 존재 | 전체 알림 읽음 상태로 업데이트 |

---

## 4. 액터별 접근 가능 기능 매트릭스

### 4.1 전체 매트릭스

| UC ID | 유스케이스명 | 비회원 | 보호자 | 어르신 | AI 시스템 | API 엔드포인트 |
|-------|------------|--------|--------|--------|-----------|---------------|
| UC-01 | 회원가입 | O | - | - | - | POST /api/signup |
| UC-02 | 로그인 | O | O | - | - | POST /api/login |
| UC-03 | 비밀번호 변경 | - | O | - | - | POST /api/change-password |
| UC-04 | 아이디 중복 확인 | O | - | - | - | POST /api/check-duplicate |
| UC-05 | 정보 수정 | - | O | - | - | POST /api/update-guardian, /api/update-senior |
| UC-06 | 음성 녹음 | - | - | O | - | (클라이언트 MediaRecorder) |
| UC-07 | STT 변환 | - | - | - | O | POST /api/analyze (step 2~3) |
| UC-08 | 감정 분석 | - | - | - | O | POST /api/analyze (step 4) |
| UC-09 | 음성 점수 산출 | - | - | - | O | POST /api/analyze (step 4) |
| UC-10 | Q&A 매칭 | - | - | - | O | POST /api/analyze (step 5) |
| UC-11 | LLM 대화 생성 | - | - | - | O | POST /api/analyze (step 5) |
| UC-12 | TTS 응답 생성 | - | - | - | O | POST /api/analyze (step 5.5~5.7) |
| UC-13 | 대시보드 조회 | - | O | - | - | (페이지 렌더링) |
| UC-14 | 일간 리포트 | - | O | - | - | POST /api/activity-daily |
| UC-15 | 주간 리포트 | - | O | - | - | POST /api/activity-weekly |
| UC-16 | 월간 리포트 | - | O | - | - | POST /api/activity-monthly |
| UC-17 | 디바이스 등록 | - | O | - | - | POST /api/add-device |
| UC-18 | 센서 확인 | - | O | - | - | POST/GET /api/check-sensor |
| UC-19 | 음성 세션 생성 | - | O | - | - | POST /api/create-voice-session |
| UC-20 | 알림 생성 | - | - | - | O | (내부 자동 처리) |
| UC-21 | 알림 확인 | - | O | - | - | GET /api/check-alert |
| UC-21-1 | 알림 목록 조회 | - | O | - | - | POST /api/alert-list |
| UC-22 | 알림 읽음 처리 | - | O | - | - | POST /api/alert-read-all |

### 4.2 액터별 기능 수 요약

| 액터 | 접근 가능 유스케이스 수 | 주요 역할 |
|------|----------------------|----------|
| 비회원 (Guest) | 3개 | 회원가입, 로그인, 아이디 중복 확인 |
| 보호자 (Guardian) | 14개 | 로그인, 정보 관리, 대시보드, 리포트, 디바이스, 알림 |
| 어르신 (Senior) | 1개 | 음성 녹음 (보미와 음성 대화 시작) |
| AI 시스템 (AI System) | 7개 | STT, 감정 분석, 점수 산출, Q&A 매칭, LLM, TTS, 알림 생성 |

---

## 5. 유스케이스 관계 정의

### 5.1 Include 관계 (필수 포함)

Include 관계는 기본 유스케이스가 실행될 때 반드시 포함되어 실행되는 유스케이스를 나타낸다.

| 기본 유스케이스 | <<include>> | 포함 유스케이스 | 설명 |
|---------------|-------------|---------------|------|
| UC-01 회원가입 | <<include>> | UC-04 아이디 중복 확인 | 회원가입 시 아이디 중복 여부를 반드시 확인 |
| UC-06 음성 녹음 | <<include>> | UC-07 STT 변환 | 녹음된 음성은 반드시 STT로 텍스트 변환 |
| UC-06 음성 녹음 | <<include>> | UC-08 감정 분석 | 음성 분석 시 감정 분석을 반드시 수행 |
| UC-06 음성 녹음 | <<include>> | UC-09 음성 점수 산출 | 음성 분석 시 8차원 점수를 반드시 산출 |
| UC-10 Q&A 매칭 | <<include>> | UC-12 TTS 응답 생성 | 응답 결정 후 반드시 TTS로 음성 생성 |
| UC-11 LLM 대화 생성 | <<include>> | UC-12 TTS 응답 생성 | LLM 응답 후 반드시 TTS로 음성 생성 |
| UC-17 디바이스 등록 | <<include>> | UC-18 센서 확인 | 등록 후 센서 생성 상태를 확인 |
| UC-19 음성 세션 생성 | <<include>> | UC-18 센서 확인 | 세션 생성 전 센서 존재 여부를 확인 |

### 5.2 Extend 관계 (조건부 확장)

Extend 관계는 특정 조건이 충족될 때 기본 유스케이스에 추가로 실행되는 유스케이스를 나타낸다.

| 기본 유스케이스 | <<extend>> | 확장 유스케이스 | 확장 조건 |
|---------------|------------|---------------|----------|
| UC-10 Q&A 매칭 | <<extend>> | UC-11 LLM 대화 생성 | Q&A 데이터셋에서 매칭 실패 시 GPT-4o-mini API 호출 |
| UC-13 대시보드 조회 | <<extend>> | UC-14 일간 리포트 | 보호자가 일간 탭 선택 시 |
| UC-13 대시보드 조회 | <<extend>> | UC-15 주간 리포트 | 보호자가 주간 탭 선택 시 |
| UC-13 대시보드 조회 | <<extend>> | UC-16 월간 리포트 | 보호자가 월간 탭 선택 시 |
| UC-08 감정 분석 | <<extend>> | UC-20 알림 생성 | 분석 결과가 위험 조건 충족 시 (평균 < 50 또는 감정 < 40) |

### 5.3 관계 다이어그램 요약

```
UC-01 회원가입 ──<<include>>──> UC-04 아이디 중복 확인

UC-06 음성 녹음 ──<<include>>──> UC-07 STT 변환
               ──<<include>>──> UC-08 감정 분석 ──<<extend>>──> UC-20 알림 생성
               ──<<include>>──> UC-09 음성 점수 산출            (위험 감지 시)

UC-10 Q&A 매칭 ──<<extend>>───> UC-11 LLM 대화 생성 (매칭 실패 시)
               ──<<include>>──> UC-12 TTS 응답 생성
UC-11 LLM 대화 ──<<include>>──> UC-12 TTS 응답 생성

UC-13 대시보드 ──<<extend>>───> UC-14 일간 리포트
               ──<<extend>>───> UC-15 주간 리포트
               ──<<extend>>───> UC-16 월간 리포트

UC-17 디바이스 등록 ──<<include>>──> UC-18 센서 확인
UC-19 음성 세션 생성 ──<<include>>──> UC-18 센서 확인
```

### 5.4 전체 유스케이스 흐름도

어르신이 보미와 대화하는 전체 흐름을 시간 순서대로 나타낸다.

```
[보호자]                              [어르신]                        [AI 시스템]
   │                                     │                               │
   │  UC-02 로그인                       │                               │
   ├─────────────────>                   │                               │
   │                                     │                               │
   │  UC-17 디바이스 등록                │                               │
   ├─────────────────>                   │                               │
   │                                     │                               │
   │  UC-19 음성 세션 생성               │                               │
   ├─────────────────>                   │                               │
   │                                     │                               │
   │                                     │  UC-06 음성 녹음               │
   │                                     ├──────────────────────────────>│
   │                                     │                               │
   │                                     │               UC-07 STT 변환  │
   │                                     │<──────────────────────────────┤
   │                                     │                               │
   │                                     │            UC-08 감정 분석     │
   │                                     │            UC-09 점수 산출     │
   │                                     │<──────────────────────────────┤
   │                                     │                               │
   │                                     │            UC-10 Q&A 매칭     │
   │                                     │              (또는 UC-11 LLM) │
   │                                     │<──────────────────────────────┤
   │                                     │                               │
   │                                     │           UC-12 TTS 응답 생성 │
   │                                     │<──────────────────────────────┤
   │                                     │                               │
   │                          (음성 응답 청취)                           │
   │                                     │                               │
   │  UC-13 대시보드 조회                │            UC-20 알림 생성     │
   │  (분석 결과 확인)                   │            (위험 감지 시)      │
   │<────────────────────────────────────┼───────────────────────────────┤
   │                                     │                               │
   │  UC-21 알림 확인                    │                               │
   ├─────────────────>                   │                               │
   │                                     │                               │
```

---

## 문서 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-02-09 | - | 최초 작성. 4개 액터, 6개 서브시스템, 23개 유스케이스, Include/Extend 관계 정의 |
