# 늘봄 시스템 요구사항 정의서

## 문서 정보

| 항목 | 내용 |
|------|------|
| 프로젝트명 | 늘봄 (AI 기반 노인 돌봄 음성 분석 시스템) |
| 문서 버전 | 1.0 |
| 작성일 | 2026-02-09 |
| 개발 기간 | 2025년 12월 ~ 2026년 2월 (2025.12.05 ~ 2026.02.10) |
| 개발 인원 | 5명 (최선임 총괄기획, 지태민 프론트엔드, 김승민 백엔드, 최대영 DB/IoT, 조민솔 기획/문서) |

---

## 1. 프로젝트 개요

### 1.1 프로젝트 목적
늘봄은 AI 음성 분석 기술을 활용하여 독거 어르신의 건강 상태와 감정을 모니터링하고, AI 대화 도우미 '보미(Bomi)'를 통해 정서적 교류를 제공하는 노인 돌봄 시스템입니다. 보호자(가족/요양사)에게 실시간 분석 리포트와 알림을 전달하여 원격 돌봄을 가능하게 합니다.

### 1.2 프로젝트 범위
- AI 음성 분석 및 감정 인식 시스템
- AI 대화 도우미 '보미' (LLM 기반 대화)
- 음성-텍스트 변환 (STT) 시스템
- 텍스트-음성 변환 (TTS) 시스템
- 보호자 대시보드 및 리포트
- IoT 디바이스/센서 관리
- 알림 시스템

### 1.3 용어 정의

| 용어 | 설명 |
|------|------|
| 보호자 (Guardian) | 어르신을 돌보는 가족 또는 요양사. 시스템에 로그인하여 대시보드를 확인 |
| 어르신 (Senior) | 돌봄 대상인 고령자. 음성 대화를 통해 시스템과 상호작용 |
| 보미 (Bomi) | AI 대화 도우미 캐릭터. 어르신과 음성 대화 수행 |
| STT | Speech-to-Text, 음성을 텍스트로 변환 |
| TTS | Text-to-Speech, 텍스트를 음성으로 변환 |
| 감정 분석 | 텍스트 및 오디오 신호를 통해 감정 상태를 판별 |
| VPR | Voice Pitch Ratio, 음성 피치 비율 (활력 지표) |
| TTR | Type-Token Ratio, 어휘 다양성 비율 |
| 센싱 (Sensing) | IoT 센서가 수집하는 데이터 (음성/동작/환경) |

---

## 2. 시스템 구성

### 2.1 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────────┐
│                     Client (Browser / Device)                       │
│  ┌──────────────────┐  ┌───────────────────────────────────────┐   │
│  │  보호자 대시보드   │  │  어르신 음성 대화 인터페이스 (보미)    │   │
│  │  (PC/모바일)      │  │  (IoT 디바이스 / 브라우저)            │   │
│  └────────┬─────────┘  └──────────────────┬────────────────────┘   │
└───────────┼────────────────────────────────┼───────────────────────┘
            │ HTTPS                          │ HTTPS (Audio Stream)
            └────────────────┬───────────────┘
                             ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    Flask Web Server (:5000)                          │
│  ┌────────────────────────────────────────────────────────────────┐ │
│  │  /api/login    /api/signup    /api/analyze                     │ │
│  │  /api/activity-daily   /api/activity-weekly                    │ │
│  │  /api/activity-monthly   /api/check-alert                     │ │
│  │  /api/update-guardian   /api/update-senior                     │ │
│  │  /api/add-device   /api/check-sensor                          │ │
│  │  /api/create-voice-session   /api/tts-audio/<file>            │ │
│  └────────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────────┐  │
│  │  Whisper STT  │  │  Emotion     │  │  LLM Handler            │  │
│  │  (faster-     │  │  Ensemble    │  │  (OpenAI GPT-4o-mini    │  │
│  │   whisper)    │  │  (Text+Audio)│  │   + Q&A Dataset)        │  │
│  └──────────────┘  └──────────────┘  └──────────────────────────┘  │
│                                                                     │
│  ┌──────────────┐  ┌──────────────┐                                │
│  │  Edge TTS    │  │  Analyzer    │                                │
│  │  (음성 합성)  │  │  (8차원 점수)│                                │
│  └──────────────┘  └──────────────┘                                │
└───────────────────────────┬─────────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────────┐
│                    MySQL Database (care_db)                          │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────────┐  │
│  │ tb_guardian │ │ tb_senior  │ │ tb_device  │ │ tb_sensor      │  │
│  │ tb_sensing │ │ tb_voice_  │ │ tb_analysis│ │ tb_alert       │  │
│  │            │ │    log     │ │            │ │                │  │
│  └────────────┘ └────────────┘ └────────────┘ └────────────────┘  │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 포트 구성

| 서비스 | 포트 | 설명 |
|--------|------|------|
| **Flask Web Server** | 5000 | 메인 웹 서버 (HTTPS) |
| **FastAPI Server** | 8000 | 대안 음성 분석 서버 |
| **MySQL** | 3306 | 관계형 데이터베이스 (192.168.0.31) |

---

## 3. 기능 요구사항

### 3.1 사용자 관리

| 요구사항 ID | 요구사항명 | 설명 | 우선순위 |
|------------|-----------|------|----------|
| UR-001 | 보호자 회원가입 | 보호자 계정 생성 및 어르신 정보 등록 | 필수 |
| UR-002 | 로그인 | 보호자 계정 인증 및 세션 관리 | 필수 |
| UR-003 | 보호자 정보 수정 | 보호자 개인정보 변경 | 필수 |
| UR-004 | 어르신 정보 수정 | 돌봄 대상 어르신 정보 변경 | 필수 |
| UR-005 | 비밀번호 변경 | 보호자 비밀번호 변경 | 필수 |

### 3.2 음성 분석

| 요구사항 ID | 요구사항명 | 설명 | 우선순위 |
|------------|-----------|------|----------|
| VA-001 | 음성 녹음 및 전송 | 어르신 음성을 녹음하여 서버에 전송 | 필수 |
| VA-002 | STT 변환 | Whisper 모델을 통한 음성-텍스트 변환 | 필수 |
| VA-003 | 감정 분석 | 텍스트+오디오 앙상블 감정 인식 (6가지 감정) | 필수 |
| VA-004 | 음성 품질 점수 | 8차원 종합 음성 분석 점수 산출 | 필수 |
| VA-005 | 피치 분석 | YIN 알고리즘 기반 음성 피치 역동성 분석 | 필수 |
| VA-006 | 실시간 분석 진행 | SSE 스트리밍을 통한 분석 진행 상태 표시 | 권장 |

### 3.3 AI 대화 (보미)

| 요구사항 ID | 요구사항명 | 설명 | 우선순위 |
|------------|-----------|------|----------|
| AI-001 | Q&A 데이터셋 매칭 | 사전 정의된 Q&A 쌍을 통한 신뢰성 높은 응답 | 필수 |
| AI-002 | LLM 대화 생성 | GPT-4o-mini를 통한 감정 인식 대화 생성 | 필수 |
| AI-003 | TTS 음성 합성 | Edge TTS를 통한 응답 음성 생성 | 필수 |
| AI-004 | 대화 이력 관리 | 대화 컨텍스트 유지 및 관리 | 권장 |

### 3.4 대시보드 및 리포트

| 요구사항 ID | 요구사항명 | 설명 | 우선순위 |
|------------|-----------|------|----------|
| DR-001 | 보호자 대시보드 | 감정, 활동, 인지 상태 종합 현황 표시 | 필수 |
| DR-002 | 일간 활동 리포트 | 일별 음성 분석 결과 조회 | 필수 |
| DR-003 | 주간 활동 리포트 | 주간 트렌드 분석 결과 조회 | 필수 |
| DR-004 | 월간 활동 리포트 | 월간 요약 리포트 조회 | 필수 |
| DR-005 | 감정 분석 차트 | 감정 변화 추이 시각화 | 권장 |

### 3.5 디바이스 관리

| 요구사항 ID | 요구사항명 | 설명 | 우선순위 |
|------------|-----------|------|----------|
| DV-001 | 디바이스 등록 | 음성 수집 디바이스 등록 | 필수 |
| DV-002 | 센서 상태 확인 | 센서(음성/동작/환경) 동작 상태 확인 | 필수 |
| DV-003 | 음성 세션 생성 | 음성 수집 세션 시작 및 sensing_id 발급 | 필수 |

### 3.6 알림 시스템

| 요구사항 ID | 요구사항명 | 설명 | 우선순위 |
|------------|-----------|------|----------|
| AL-001 | 실시간 알림 확인 | 보호자에게 어르신 상태 알림 전달 | 필수 |
| AL-002 | 위험 감지 알림 | 분석 점수 기반 위험 상태 알림 | 필수 |

---

## 4. 비기능 요구사항

### 4.1 성능 요구사항

| 요구사항 ID | 항목 | 목표값 | 설명 |
|------------|------|--------|------|
| NF-001 | STT 처리 시간 | < 오디오 길이의 1x | Whisper tiny 모델 int8 최적화 |
| NF-002 | 감정 분석 응답 | < 3초 | 텍스트+오디오 앙상블 분석 |
| NF-003 | TTS 생성 시간 | < 5초 | Edge TTS 비동기 생성 |
| NF-004 | API 응답 시간 | < 2초 | 일반 API 엔드포인트 |

### 4.2 보안 요구사항

| 요구사항 ID | 항목 | 설명 |
|------------|------|------|
| NF-005 | HTTPS 통신 | SSL 인증서를 통한 암호화 통신 |
| NF-006 | API 키 관리 | OpenAI API 키 환경변수 관리 |

### 4.3 호환성 요구사항

| 요구사항 ID | 항목 | 설명 |
|------------|------|------|
| NF-007 | 브라우저 호환 | Chrome, Edge, Safari 최신 버전 지원 |
| NF-008 | 반응형 디자인 | PC 및 모바일 화면 대응 |

---

## 5. 데이터베이스 설계

### 5.1 테이블 구조

| 테이블명 | 설명 | 주요 컬럼 |
|----------|------|----------|
| tb_guardian | 보호자 정보 | guardian_id, user_id, password, name, phone, address |
| tb_senior | 어르신 정보 | senior_id, name, birthdate, gender, phone, guardian_id |
| tb_device | IoT 디바이스 | device_id, device_uid, device_name, location, senior_id |
| tb_sensor | 센서 정보 | sensor_id, device_id, sensor_type (voice/motion/env) |
| tb_sensing | 센서 데이터 | sensing_id, sensor_id, value, created_at |
| tb_voice_log | 음성 분석 결과 | voice_id, senior_id, sensing_id, voice_text, response_time_sec |
| tb_analysis | 감정 분석 상세 | analysis_id, voice_idx, emotion_label, stt_text, 감정별 비율 |
| tb_alert | 알림 정보 | alert_id, alert_type, alert_content, sented_at, received_yes |

### 5.2 ER 다이어그램

```
tb_guardian (1) ──── (N) tb_senior
                              │
                              │ (1)
                              ▼
                         tb_device (N)
                              │
                              │ (1)
                              ▼
                         tb_sensor (N)
                              │
                              │ (1)
                              ▼
                         tb_sensing (N)
                              │
                              │
              ┌───────────────┴───────────────┐
              ▼                               ▼
        tb_voice_log (N)                tb_alert (N)
              │
              │ (1)
              ▼
        tb_analysis (1)
```

---

## 문서 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-02-09 | - | 최초 작성 |
