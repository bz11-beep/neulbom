<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>늘봄 - 최종 결과 보고서</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');

        :root {
            --primary: #059669;
            --primary-light: #34D399;
            --primary-dark: #047857;
            --accent: #10B981;
            --accent-light: #D1FAE5;
            --bg: #F0FDF4;
            --bg-card: #FFFFFF;
            --bg-section: #ECFDF5;
            --text: #1F2937;
            --text-light: #4B5563;
            --text-muted: #9CA3AF;
            --border: #A7F3D0;
            --border-light: #D1FAE5;
            --success: #059669;
            --danger: #DC2626;
            --warning: #F59E0B;
            --info: #3B82F6;
            --warm: #F59E0B;
            --warm-light: #FEF3C7;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.8;
            font-size: 15px;
        }

        /* ===== COVER PAGE ===== */
        .cover {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(160deg, #ECFDF5 0%, #A7F3D0 30%, #34D399 70%, #059669 100%);
            text-align: center;
            padding: 60px 40px;
            position: relative;
            overflow: hidden;
        }
        .cover::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse 300px 200px at 15% 80%, rgba(4,120,87,0.08) 0%, transparent 70%),
                radial-gradient(ellipse 400px 300px at 85% 20%, rgba(5,150,105,0.1) 0%, transparent 60%),
                repeating-linear-gradient(
                    0deg, transparent, transparent 39px,
                    rgba(4,120,87,0.04) 39px, rgba(4,120,87,0.04) 40px
                ),
                repeating-linear-gradient(
                    90deg, transparent, transparent 39px,
                    rgba(4,120,87,0.04) 39px, rgba(4,120,87,0.04) 40px
                );
            pointer-events: none;
        }
        .cover-icon { font-size: 90px; margin-bottom: 10px; position: relative; z-index: 1; }
        .cover h1 {
            font-size: 3.2rem; font-weight: 900; color: var(--primary-dark);
            margin-bottom: 8px; position: relative; z-index: 1;
            text-shadow: 0 2px 8px rgba(255,255,255,0.5);
        }
        .cover .cover-subtitle {
            font-size: 1.4rem; color: var(--primary); font-weight: 500;
            margin-bottom: 30px; position: relative; z-index: 1;
        }
        .cover .cover-slogan {
            font-size: 1.1rem; color: var(--text-light); font-style: italic;
            margin-bottom: 50px; position: relative; z-index: 1;
        }
        .cover-meta {
            position: relative; z-index: 1;
            background: rgba(255,255,255,0.8); border-radius: 16px;
            padding: 30px 50px; backdrop-filter: blur(8px);
            border: 1px solid var(--border);
        }
        .cover-meta table { margin: 0 auto; border-collapse: collapse; }
        .cover-meta td { padding: 6px 20px; font-size: 1rem; }
        .cover-meta td:first-child { font-weight: 700; color: var(--primary-dark); text-align: right; }
        .cover-meta td:last-child { color: var(--text); text-align: left; }
        .cover-badges {
            position: relative; z-index: 1;
            display: flex; gap: 12px; flex-wrap: wrap; justify-content: center;
            margin-top: 30px;
        }
        .cover-badge {
            display: inline-flex; align-items: center; gap: 6px;
            background: rgba(255,255,255,0.85); border-radius: 20px;
            padding: 6px 16px; font-size: 0.85rem; font-weight: 500;
            border: 1px solid var(--border);
        }
        .cover-badge .dot {
            width: 8px; height: 8px; border-radius: 50%;
        }
        .dot-flask { background: #000000; }
        .dot-fastapi { background: #009688; }
        .dot-ai { background: #FF6F00; }
        .dot-whisper { background: #74AA9C; }
        .dot-tts { background: #0078D4; }
        .dot-mysql { background: #4479A1; }

        /* ===== TOC ===== */
        .toc {
            max-width: 800px; margin: 60px auto; padding: 0 30px;
        }
        .toc h2 {
            font-size: 1.6rem; color: var(--primary-dark); margin-bottom: 20px;
            padding-bottom: 10px; border-bottom: 3px solid var(--primary);
        }
        .toc-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
        }
        .toc-item {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 14px; background: var(--bg-card);
            border-radius: 8px; border: 1px solid var(--border-light);
            text-decoration: none; color: var(--text);
            transition: all 0.2s;
        }
        .toc-item:hover {
            border-color: var(--primary); background: var(--accent-light);
            transform: translateX(4px);
        }
        .toc-num {
            width: 28px; height: 28px; border-radius: 50%;
            background: var(--primary); color: white;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.8rem; font-weight: 700; flex-shrink: 0;
        }

        /* ===== SECTIONS ===== */
        .content { max-width: 1100px; margin: 0 auto; padding: 0 30px 60px; }
        section { margin-bottom: 60px; }
        .section-header {
            display: flex; align-items: center; gap: 14px;
            margin-bottom: 30px; padding-bottom: 14px;
            border-bottom: 3px solid var(--primary);
        }
        .section-num {
            width: 40px; height: 40px; border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white; display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; font-weight: 900; flex-shrink: 0;
        }
        .section-header h2 {
            font-size: 1.5rem; color: var(--primary-dark); font-weight: 700;
        }

        h3 {
            font-size: 1.15rem; color: var(--primary-dark); font-weight: 700;
            margin: 25px 0 12px; padding-left: 12px;
            border-left: 4px solid var(--primary);
        }
        h4 {
            font-size: 1rem; color: var(--text); font-weight: 600;
            margin: 18px 0 8px;
        }

        p { margin-bottom: 12px; color: var(--text-light); }
        ul, ol { margin: 8px 0 16px 24px; color: var(--text-light); }
        li { margin-bottom: 4px; }

        /* ===== TABLES ===== */
        table {
            width: 100%; border-collapse: collapse; margin: 12px 0 20px;
            background: var(--bg-card); border-radius: 10px; overflow: hidden;
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
        }
        thead { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); }
        thead th {
            padding: 10px 14px; color: white; font-weight: 600;
            font-size: 0.88rem; text-align: left; white-space: nowrap;
        }
        tbody td {
            padding: 9px 14px; border-bottom: 1px solid var(--border-light);
            font-size: 0.9rem; color: var(--text);
        }
        tbody tr:hover { background: var(--accent-light); }
        tbody tr:last-child td { border-bottom: none; }

        /* ===== CODE BLOCKS ===== */
        pre {
            background: #1E1E2E; color: #CDD6F4; padding: 18px 22px;
            border-radius: 10px; overflow-x: auto; margin: 12px 0 20px;
            font-size: 0.85rem; line-height: 1.6;
            font-family: 'Consolas', 'Monaco', monospace;
            border: 1px solid #313244;
        }
        code {
            font-family: 'Consolas', 'Monaco', monospace;
            background: var(--accent-light); padding: 2px 6px;
            border-radius: 4px; font-size: 0.88em; color: var(--primary-dark);
        }
        pre code { background: none; padding: 0; color: inherit; }

        /* ===== CARDS ===== */
        .card {
            background: var(--bg-card); border-radius: 12px;
            border: 1px solid var(--border-light); padding: 20px;
            margin: 12px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .card-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px; margin: 16px 0;
        }
        .stat-card {
            background: var(--bg-card); border-radius: 12px;
            border: 1px solid var(--border-light); padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .stat-card .stat-value {
            font-size: 2rem; font-weight: 900; color: var(--primary);
            margin-bottom: 4px;
        }
        .stat-card .stat-label {
            font-size: 0.85rem; color: var(--text-muted);
        }

        /* ===== BADGES ===== */
        .badge {
            display: inline-block; padding: 3px 10px; border-radius: 12px;
            font-size: 0.78rem; font-weight: 600; margin: 0 2px;
        }
        .badge-guardian { background: #EBF5FB; color: #2563EB; }
        .badge-senior { background: #FEF3C7; color: #D97706; }
        .badge-public { background: #ECFDF5; color: #059669; }
        .badge-ai { background: #FFF7ED; color: #EA580C; }
        .badge-success { background: #ECFDF5; color: #059669; }
        .badge-done { background: #ECFDF5; color: #059669; }
        .badge-sensor { background: #F3E8FF; color: #7C3AED; }

        /* ===== SCREENSHOTS ===== */
        .screenshot-section { margin: 20px 0; }
        .screenshot-group {
            background: var(--bg-card); border-radius: 14px;
            border: 1px solid var(--border-light); padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
        }
        .screenshot-group h4 {
            font-size: 1.05rem; color: var(--primary-dark);
            margin-bottom: 12px; padding: 0;
            display: flex; align-items: center; gap: 8px;
        }
        .screenshot-group h4 .screen-num {
            background: var(--primary); color: white;
            width: 26px; height: 26px; border-radius: 50%;
            display: inline-flex; align-items: center; justify-content: center;
            font-size: 0.75rem; font-weight: 700;
        }
        .screenshot-img {
            width: 100%; border-radius: 10px;
            border: 1px solid var(--border);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            margin: 10px 0;
        }
        .screenshot-desc {
            color: var(--text-light); font-size: 0.9rem;
            margin-top: 10px;
        }
        .screenshot-desc ul { margin: 6px 0 0 20px; }
        .screenshot-desc li { margin-bottom: 3px; }

        /* ===== ARCHITECTURE ===== */
        .arch-box {
            background: #1E1E2E; color: #CDD6F4;
            padding: 24px; border-radius: 12px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.82rem; line-height: 1.5;
            overflow-x: auto; margin: 16px 0;
            border: 1px solid #313244;
        }

        /* ===== CHALLENGE TABLE ===== */
        .challenge-table td:first-child {
            font-weight: 600; color: var(--primary-dark);
            white-space: nowrap;
        }

        /* ===== PIPELINE ===== */
        .pipeline-flow {
            display: flex; align-items: center; gap: 8px;
            flex-wrap: wrap; margin: 16px 0;
        }
        .pipeline-step {
            background: var(--bg-card); border: 2px solid var(--border);
            border-radius: 10px; padding: 10px 16px;
            font-size: 0.85rem; font-weight: 600; color: var(--primary-dark);
            text-align: center;
        }
        .pipeline-step.ai {
            border-color: var(--primary); background: var(--accent-light);
        }
        .pipeline-arrow {
            color: var(--primary); font-weight: bold; font-size: 1.2rem;
        }

        /* ===== SCORING TABLE ===== */
        .scoring-table thead th { font-size: 0.8rem; }
        .scoring-table tbody td { font-size: 0.85rem; }
        .scoring-table td:nth-child(5) {
            font-weight: 700; color: var(--primary);
        }

        /* ===== FOOTER ===== */
        .footer {
            text-align: center; padding: 40px; margin-top: 40px;
            border-top: 2px solid var(--border);
            color: var(--text-muted); font-size: 0.9rem;
        }
        .footer .brand {
            font-size: 1.3rem; font-weight: 900; color: var(--primary);
            margin-bottom: 6px;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .cover h1 { font-size: 2.2rem; }
            .toc-grid { grid-template-columns: 1fr; }
            .card-grid { grid-template-columns: 1fr; }
            .cover-meta { padding: 20px 24px; }
            thead th, tbody td { padding: 7px 10px; font-size: 0.82rem; }
            .pipeline-flow { flex-direction: column; }
        }

        @media print {
            .cover { min-height: auto; padding: 40px; }
            section { page-break-inside: avoid; }
            .screenshot-group { page-break-inside: avoid; }
        }
    </style>
</head>
<body>

<!-- ========== COVER ========== -->
<div class="cover">
    <div class="cover-icon">&#127807;</div>
    <h1>늘봄</h1>
    <div class="cover-subtitle">AI 기반 노인 돌봄 음성 분석 시스템</div>
    <div class="cover-slogan">"항상 봄처럼 따뜻한 돌봄" - AI 음성 분석으로 어르신의 건강과 감정을 지킵니다</div>
    <div class="cover-meta">
        <table>
            <tr><td>프로젝트명</td><td>늘봄 (AI 기반 노인 돌봄 음성 분석 시스템)</td></tr>
            <tr><td>문서 유형</td><td>최종 결과 보고서</td></tr>
            <tr><td>작성일</td><td>2026-02-09</td></tr>
            <tr><td>개발 기간</td><td>2025년 12월 ~ 2026년 2월 (2025.12.05 ~ 2026.02.10)</td></tr>
            <tr><td>개발 인원</td><td>5명 (최선임 총괄기획, 지태민 프론트엔드, 김승민 백엔드, 최대영 DB/IoT, 조민솔 기획/문서)</td></tr>
            <tr><td>핵심 기술</td><td>멀티모달 감정 앙상블 + 8차원 음성 분석 + GPT-4o-mini 대화</td></tr>
        </table>
    </div>
    <div class="cover-badges">
        <span class="cover-badge"><span class="dot dot-flask"></span> Flask</span>
        <span class="cover-badge"><span class="dot dot-fastapi"></span> FastAPI</span>
        <span class="cover-badge"><span class="dot dot-whisper"></span> Whisper STT</span>
        <span class="cover-badge"><span class="dot dot-ai"></span> KcELECTRA + Wav2Vec2</span>
        <span class="cover-badge"><span class="dot dot-ai"></span> GPT-4o-mini</span>
        <span class="cover-badge"><span class="dot dot-tts"></span> Edge TTS</span>
        <span class="cover-badge"><span class="dot dot-mysql"></span> MySQL</span>
    </div>
</div>

<!-- ========== TOC ========== -->
<div class="toc">
    <h2>목차</h2>
    <div class="toc-grid">
        <a class="toc-item" href="#sec1"><span class="toc-num">1</span> 프로젝트 개요</a>
        <a class="toc-item" href="#sec2"><span class="toc-num">2</span> 시스템 아키텍처</a>
        <a class="toc-item" href="#sec3"><span class="toc-num">3</span> 기술 스택</a>
        <a class="toc-item" href="#sec4"><span class="toc-num">4</span> 데이터베이스 설계</a>
        <a class="toc-item" href="#sec5"><span class="toc-num">5</span> 주요 기능 구현</a>
        <a class="toc-item" href="#sec6"><span class="toc-num">6</span> 화면 구성 (스크린샷)</a>
        <a class="toc-item" href="#sec7"><span class="toc-num">7</span> API 설계</a>
        <a class="toc-item" href="#sec8"><span class="toc-num">8</span> 보안 설계</a>
        <a class="toc-item" href="#sec9"><span class="toc-num">9</span> 배포 환경</a>
        <a class="toc-item" href="#sec10"><span class="toc-num">10</span> 프로젝트 성과</a>
    </div>
</div>

<!-- ========== CONTENT ========== -->
<div class="content">

<!-- SECTION 1 -->
<section id="sec1">
    <div class="section-header">
        <div class="section-num">1</div>
        <h2>프로젝트 개요</h2>
    </div>

    <h3>1.1 프로젝트 배경</h3>
    <p>우리나라는 급속한 고령화로 인해 독거 어르신 인구가 지속적으로 증가하고 있으며, 2025년 기준 65세 이상 독거노인 수는 약 200만 명을 넘어서고 있습니다. 독거 어르신은 사회적 고립, 건강 악화, 돌발 사고 등의 위험에 노출되어 있으나, 돌봄 인력의 부족으로 24시간 상시 케어가 어려운 실정입니다.</p>
    <p>기존의 노인 돌봄 서비스는 정기 방문 또는 단순한 안부 전화 수준에 머물러 있어, 어르신의 감정 변화나 건강 이상 징후를 조기에 감지하기 어렵습니다. 특히 <strong>음성은 인간의 심리 상태, 인지 기능, 신체 건강을 반영하는 핵심 바이오마커</strong>로서, AI 기반 음성 분석 기술을 활용하면 비접촉 방식으로 어르신의 상태를 지속적으로 모니터링할 수 있습니다.</p>

    <h3>1.2 프로젝트 목적</h3>
    <p><strong>늘봄</strong>은 다음 목적을 달성하기 위해 개발되었습니다:</p>
    <ul>
        <li><strong>AI 음성 분석을 통한 건강 모니터링</strong>: 음성의 속도, 피치, 감정, 어휘력 등 8가지 차원을 분석하여 어르신의 인지 및 정서 상태를 정량적으로 평가</li>
        <li><strong>AI 대화 도우미 '보미'를 통한 정서적 교류</strong>: 감정 인식 기반의 공감 대화를 제공하여 독거 어르신의 외로움 완화</li>
        <li><strong>보호자 원격 돌봄 지원</strong>: 대시보드 및 리포트를 통해 보호자가 어르신의 상태를 실시간으로 확인</li>
        <li><strong>비접촉 돌봄 인프라 구축</strong>: IoT 디바이스와 센서를 활용한 자연스러운 돌봄 환경 조성</li>
    </ul>

    <h3>1.3 서비스 구성</h3>
    <table>
        <thead><tr><th>서비스</th><th>포트</th><th>프레임워크</th><th>설명</th></tr></thead>
        <tbody>
            <tr><td><strong>Flask Web Server</strong></td><td>5000</td><td>Flask</td><td>메인 웹 서버 (프론트엔드 + API + 음성분석)</td></tr>
            <tr><td><strong>FastAPI Analysis Server</strong></td><td>8000</td><td>FastAPI</td><td>대안 음성 분석 전용 API 서버</td></tr>
            <tr><td><strong>MySQL Database</strong></td><td>3306</td><td>MySQL</td><td>관계형 데이터베이스 (care_db)</td></tr>
        </tbody>
    </table>

    <h3>1.4 팀 구성</h3>
    <table>
        <thead><tr><th>이름</th><th>구분</th><th>주요 역할</th></tr></thead>
        <tbody>
            <tr><td>최선임</td><td>총괄기획</td><td>프로젝트 전체 개념 정의, 요구사항 우선순위 결정, 일정/리스크 관리, 산출물 품질관리</td></tr>
            <tr><td>지태민</td><td>프론트엔드</td><td>프론트 화면 UI 구현, 어르신 친화 UX 적용, 반응형 및 접근성 기본 적용</td></tr>
            <tr><td>김승민</td><td>백엔드</td><td>서비스 API 설계 및 구현, AI 모듈 호출 파이프라인 연결, 점수 산출 로직</td></tr>
            <tr><td>최대영</td><td>DB/IoT</td><td>DB 설계 및 관리, IoT 센서/디바이스 로그 수집, 생활 데이터 통합</td></tr>
            <tr><td>조민솔</td><td>기획/문서</td><td>회의 운영 지원, WBS 업데이트, 시연 시나리오/FAQ/사용 가이드 작성</td></tr>
        </tbody>
    </table>

    <h3>1.5 주요 특징</h3>
    <div class="card-grid">
        <div class="stat-card">
            <div class="stat-value">8</div>
            <div class="stat-label">음성 분석 차원 (다차원 평가)</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">6</div>
            <div class="stat-label">감정 분류 클래스</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">50+</div>
            <div class="stat-label">Q&A 데이터셋 (시맨틱 매칭)</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">9</div>
            <div class="stat-label">프론트엔드 화면</div>
        </div>
    </div>
</section>

<!-- SECTION 2 -->
<section id="sec2">
    <div class="section-header">
        <div class="section-num">2</div>
        <h2>시스템 아키텍처</h2>
    </div>

    <h3>2.1 전체 시스템 구성도</h3>
    <div class="arch-box"><pre style="background:transparent;border:none;padding:0;margin:0;color:inherit;">+=====================================================================+
|                     Client (Browser / Device)                        |
|  +--------------------+  +--------------------------------------+   |
|  |  보호자 대시보드     |  |  어르신 음성 대화 인터페이스 (보미)   |   |
|  |  (PC / 모바일)      |  |  (IoT 디바이스 / 브라우저)           |   |
|  +--------+-----------+  +------------------+-------------------+   |
+===========|==============================|==========================+
            | HTTPS                        | HTTPS (Audio Stream)
            +---------------+--------------+
                            |
                            v
+=====================================================================+
|                    Flask Web Server (:5000)                           |
|  +----------------------------------------------------------------+ |
|  |  API Layer                                                      | |
|  |  /api/login  /api/signup  /api/analyze  /api/check-alert        | |
|  |  /api/activity-daily  /api/activity-weekly  /api/voice-health   | |
|  |  /api/add-device  /api/check-sensor  /api/create-voice-session  | |
|  +----------------------------------------------------------------+ |
|                                                                      |
|  +---------------+  +----------------+  +-------------------------+ |
|  |  Whisper STT  |  |  Emotion       |  |  LLM Handler            | |
|  |  (faster-     |  |  Ensemble      |  |  (GPT-4o-mini           | |
|  |   whisper     |  |  KcELECTRA     |  |   + Q&A Dataset         | |
|  |   tiny/int8)  |  |  + Wav2Vec2    |  |   50+ Q&A pairs)        | |
|  +---------------+  +----------------+  +-------------------------+ |
|                                                                      |
|  +---------------+  +----------------+  +-------------------------+ |
|  |  Edge TTS     |  |  SpeechAnalyzer|  |  VoiceDBHandler         | |
|  |  (한국어 9종)  |  |  (8차원 점수)   |  |  (MySQL care_db)        | |
|  +---------------+  +----------------+  +-------------------------+ |
+===========================+==========================================+
                            |
                            v
+=====================================================================+
|                    MySQL Database (care_db)                           |
|  +--------------+ +--------------+ +--------------+ +--------------+ |
|  | tb_guardian   | | tb_senior    | | tb_device    | | tb_sensor    | |
|  +--------------+ +--------------+ +--------------+ +--------------+ |
|  +--------------+ +--------------+ +--------------+ +--------------+ |
|  | tb_sensing   | | tb_voice_log | | tb_analysis  | | tb_alert     | |
|  +--------------+ +--------------+ +--------------+ +--------------+ |
+=====================================================================+</pre></div>

    <h3>2.2 음성 분석 파이프라인</h3>
    <div class="pipeline-flow">
        <div class="pipeline-step">음성 녹음 (WAV)</div>
        <span class="pipeline-arrow">--></span>
        <div class="pipeline-step ai">STT (Whisper tiny)</div>
        <span class="pipeline-arrow">--></span>
        <div class="pipeline-step ai">감정 분석 (Ensemble)</div>
        <span class="pipeline-arrow">--></span>
        <div class="pipeline-step ai">8차원 점수 산출</div>
        <span class="pipeline-arrow">--></span>
        <div class="pipeline-step">DB 저장 + 알림</div>
    </div>
    <div class="pipeline-flow">
        <div class="pipeline-step">DB 저장 결과</div>
        <span class="pipeline-arrow">--></span>
        <div class="pipeline-step ai">Q&A 매칭 / LLM 호출</div>
        <span class="pipeline-arrow">--></span>
        <div class="pipeline-step ai">AI 응답 생성</div>
        <span class="pipeline-arrow">--></span>
        <div class="pipeline-step ai">Edge TTS 합성</div>
        <span class="pipeline-arrow">--></span>
        <div class="pipeline-step">음성 출력 (MP3)</div>
    </div>

    <h3>2.3 감정 앙상블 결정 로직</h3>
    <pre>텍스트 감정 (KcELECTRA)  ──┐
                              ├── Pitch Dynamics (Z-score) ──> 최종 감정 결정
오디오 감정 (Wav2Vec2)    ──┘

기본: 텍스트 감정 우선
예외: Z-peak > 2.5 && 오디오 강한 감정 && 신뢰도 > 0.6 => 오디오 감정 반영
Q&A 매칭 시: 데이터셋 감정/점수로 최종값 덮어쓰기</pre>
</section>

<!-- SECTION 3 -->
<section id="sec3">
    <div class="section-header">
        <div class="section-num">3</div>
        <h2>기술 스택</h2>
    </div>

    <h3>3.1 Backend</h3>
    <table>
        <thead><tr><th>기술</th><th>버전/상세</th><th>용도</th></tr></thead>
        <tbody>
            <tr><td>Flask</td><td>Port 5000</td><td>메인 웹 서버 (라우팅, API, 템플릿 렌더링)</td></tr>
            <tr><td>FastAPI</td><td>Port 8000</td><td>비동기 음성 분석 전용 API 서버</td></tr>
            <tr><td>Flask-CORS</td><td>-</td><td>CORS 처리</td></tr>
            <tr><td>Jinja2</td><td>-</td><td>서버 사이드 템플릿 렌더링</td></tr>
            <tr><td>PyMySQL</td><td>-</td><td>MySQL 데이터베이스 드라이버</td></tr>
            <tr><td>Uvicorn</td><td>-</td><td>ASGI 서버 (FastAPI 실행)</td></tr>
        </tbody>
    </table>

    <h3>3.2 AI / ML 모델</h3>
    <table>
        <thead><tr><th>기술</th><th>모델/버전</th><th>용도</th></tr></thead>
        <tbody>
            <tr><td>faster-whisper</td><td>Whisper tiny (int8)</td><td>한국어 음성 인식 (STT)</td></tr>
            <tr><td>KcELECTRA</td><td>MelissaJ/koelectra-emotion-6</td><td>텍스트 감정 분류 (6가지)</td></tr>
            <tr><td>Wav2Vec2-XLSR</td><td>jungjongho/wav2vec2-xlsr</td><td>오디오 감정 인식</td></tr>
            <tr><td>librosa</td><td>YIN 알고리즘</td><td>피치 분석 (Z-score Dynamics)</td></tr>
            <tr><td>GPT-4o-mini</td><td>OpenAI API</td><td>감정 기반 대화 생성 (LLM)</td></tr>
            <tr><td>Edge TTS</td><td>Microsoft (9종 한국어)</td><td>음성 합성 (TTS)</td></tr>
        </tbody>
    </table>

    <h3>3.3 Frontend</h3>
    <table>
        <thead><tr><th>기술</th><th>용도</th></tr></thead>
        <tbody>
            <tr><td>HTML5 + CSS3 + JavaScript (ES6+)</td><td>Jinja2 템플릿 기반 9개 페이지</td></tr>
            <tr><td>Chart.js</td><td>감정/활동 데이터 시각화</td></tr>
            <tr><td>Material Icons</td><td>Google Material Design 아이콘</td></tr>
            <tr><td>MediaRecorder API</td><td>브라우저 음성 녹음</td></tr>
            <tr><td>EventSource (SSE)</td><td>분석 진행 상태 실시간 스트리밍</td></tr>
            <tr><td>Daum Postcode API</td><td>회원가입 시 우편번호/주소 자동 입력</td></tr>
        </tbody>
    </table>

    <h3>3.4 Database & Infrastructure</h3>
    <table>
        <thead><tr><th>기술</th><th>용도</th></tr></thead>
        <tbody>
            <tr><td>MySQL (care_db)</td><td>관계형 데이터베이스 (8개 테이블)</td></tr>
            <tr><td>PyOpenSSL</td><td>자체 서명 SSL 인증서 (HTTPS)</td></tr>
            <tr><td>python-dotenv</td><td>환경변수 관리 (API 키)</td></tr>
            <tr><td>PyTorch (CUDA)</td><td>GPU 가속 딥러닝 추론</td></tr>
        </tbody>
    </table>
</section>

<!-- SECTION 4 -->
<section id="sec4">
    <div class="section-header">
        <div class="section-num">4</div>
        <h2>데이터베이스 설계</h2>
    </div>

    <h3>4.1 ER 다이어그램</h3>
    <div class="arch-box"><pre style="background:transparent;border:none;padding:0;margin:0;color:inherit;">tb_guardian (1) ────────── (N) tb_senior
                                    |
                                    | (1)
                                    v
                               tb_device (N)
                                    |
                                    | (1)
                                    v
                               tb_sensor (N)
                                    |
                                    | (1)
                                    v
                               tb_sensing (N)
                                    |
                    +---------------+---------------+
                    v                               v
              tb_voice_log (N)                tb_alert (N)
                    |
                    | (1)
                    v
              tb_analysis (1)</pre></div>

    <h3>4.2 테이블 목록 (8개)</h3>
    <table>
        <thead><tr><th>테이블</th><th>설명</th><th>주요 컬럼</th></tr></thead>
        <tbody>
            <tr><td><strong>tb_guardian</strong></td><td>보호자 (가족/요양사)</td><td>user_id, password, name, phone, relation_with_senior</td></tr>
            <tr><td><strong>tb_senior</strong></td><td>어르신 정보</td><td>name, birthdate, gender, living_type, guardian_id(FK)</td></tr>
            <tr><td><strong>tb_device</strong></td><td>IoT 디바이스</td><td>device_uid, device_name, location, senior_id(FK)</td></tr>
            <tr><td><strong>tb_sensor</strong></td><td>센서 정보</td><td>sensor_type(motion/env/voice), device_id(FK)</td></tr>
            <tr><td><strong>tb_sensing</strong></td><td>센서 수집 데이터</td><td>sensing_type, sensing_value, value, sensor_id(FK)</td></tr>
            <tr><td><strong>tb_voice_log</strong></td><td>음성 분석 기본</td><td>voice_text, response_time_sec, utterance_length</td></tr>
            <tr><td><strong>tb_analysis</strong></td><td>감정 분석 상세</td><td>emotion_label, hap/sad/neu/ang/anxi/emba_ratio</td></tr>
            <tr><td><strong>tb_alert</strong></td><td>알림 정보</td><td>alert_type, alert_content, received_yes</td></tr>
        </tbody>
    </table>

    <h3>4.3 주요 테이블 상세</h3>

    <h4>tb_guardian (보호자)</h4>
    <table>
        <thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead>
        <tbody>
            <tr><td>guardian_id</td><td>INT (PK, AI)</td><td>보호자 고유 ID</td></tr>
            <tr><td>user_id</td><td>VARCHAR</td><td>로그인 아이디</td></tr>
            <tr><td>password</td><td>VARCHAR</td><td>비밀번호</td></tr>
            <tr><td>name</td><td>VARCHAR</td><td>이름</td></tr>
            <tr><td>phone</td><td>VARCHAR</td><td>연락처</td></tr>
            <tr><td>post_num / addr1 / addr2</td><td>VARCHAR</td><td>우편번호 / 기본주소 / 상세주소</td></tr>
            <tr><td>relation_with_senior</td><td>VARCHAR</td><td>어르신과의 관계</td></tr>
            <tr><td>voice_collection_approved</td><td>CHAR(1)</td><td>음성 수집 동의 여부</td></tr>
        </tbody>
    </table>

    <h4>tb_voice_log (음성 분석 로그)</h4>
    <table>
        <thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead>
        <tbody>
            <tr><td>voice_id</td><td>INT (PK, AI)</td><td>음성 로그 고유 ID</td></tr>
            <tr><td>senior_id</td><td>INT (FK)</td><td>어르신 ID</td></tr>
            <tr><td>sensing_id</td><td>INT (FK)</td><td>센싱 ID (0이면 센서 미연결)</td></tr>
            <tr><td>voice_text</td><td>TEXT</td><td>STT 변환 텍스트</td></tr>
            <tr><td>response_time_sec</td><td>FLOAT</td><td>반응 시간 (초)</td></tr>
            <tr><td>utterance_length</td><td>FLOAT</td><td>발화 길이 (초)</td></tr>
        </tbody>
    </table>

    <h4>tb_analysis (감정 분석 상세)</h4>
    <table>
        <thead><tr><th>컬럼</th><th>타입</th><th>설명</th></tr></thead>
        <tbody>
            <tr><td>analysis_id</td><td>INT (PK, AI)</td><td>분석 고유 ID</td></tr>
            <tr><td>voice_idx</td><td>INT (FK)</td><td>음성 로그 ID</td></tr>
            <tr><td>emotion_label</td><td>VARCHAR</td><td>최종 감정 라벨</td></tr>
            <tr><td>hap_ratio / sad_ratio / neu_ratio</td><td>FLOAT</td><td>기쁨 / 슬픔 / 중립 비율</td></tr>
            <tr><td>ang_ratio / anxi_ratio / emba_ratio</td><td>FLOAT</td><td>분노 / 불안 / 당황 비율</td></tr>
        </tbody>
    </table>
</section>

<!-- SECTION 5 -->
<section id="sec5">
    <div class="section-header">
        <div class="section-num">5</div>
        <h2>주요 기능 구현</h2>
    </div>

    <h3>5.1 음성 분석 파이프라인 <span class="badge badge-ai">STT + Emotion + Scoring</span></h3>
    <ul>
        <li><strong>음성 녹음</strong>: 브라우저 MediaRecorder API 또는 PyAudio 기반 녹음 (WAV). 배경 소음 자동 보정(RMS 기반) 및 상대적 침묵 감지</li>
        <li><strong>STT 변환</strong>: faster-whisper Whisper tiny (int8 양자화), VAD 필터 적용, 한국어(ko) 고정</li>
        <li><strong>감정 앙상블</strong>: KcELECTRA(텍스트) + Wav2Vec2(오디오) + Pitch Dynamics(Z-score) 결합</li>
        <li><strong>8차원 점수 산출</strong>: Speed, Duration, Response, WordCount, Vocabulary, Silence, Emotion(x1.5), Vitality</li>
        <li><strong>AI 응답</strong>: Q&A 데이터셋 매칭 우선 -> 매칭 실패 시 GPT-4o-mini LLM 호출</li>
        <li><strong>TTS 출력</strong>: Edge TTS로 한국어 음성 합성 (9종 음성, MP3 출력)</li>
        <li><strong>SSE 스트리밍</strong>: 분석 각 단계를 실시간으로 클라이언트에 전송</li>
    </ul>

    <h3>5.2 감정 앙상블 분석 <span class="badge badge-ai">KcELECTRA + Wav2Vec2</span></h3>
    <ul>
        <li><strong>텍스트 감정 (KcELECTRA)</strong>: 6가지 감정 분류 (기쁨, 중립, 분노, 슬픔, 불안, 당황), softmax 확률분포</li>
        <li><strong>오디오 감정 (Wav2Vec2-XLSR)</strong>: 음성 파형 직접 분석 (16kHz, 최대 3초), 감정 매핑 (angry->분노, happy->기쁨 등)</li>
        <li><strong>Pitch Dynamics</strong>: librosa YIN 알고리즘으로 Z-score 기반 음성 역동성 측정</li>
        <li><strong>최종 결정</strong>: 기본 텍스트 감정 / Z-peak > 2.5 && 오디오 강한 감정 && 신뢰도 > 0.6일 때 오디오 반영</li>
    </ul>

    <h3>5.3 8차원 음성 분석 점수</h3>
    <table class="scoring-table">
        <thead><tr><th>차원</th><th>지표</th><th>최적 범위</th><th>설명</th><th>가중치</th></tr></thead>
        <tbody>
            <tr><td>Speed</td><td>WPM (분당 어절)</td><td>100~150</td><td>말의 속도</td><td>1.0</td></tr>
            <tr><td>Duration</td><td>발화 시간 (초)</td><td>3~10</td><td>적절한 발화 길이</td><td>1.0</td></tr>
            <tr><td>Response</td><td>반응 시간 (초)</td><td>0~2</td><td>질문 후 응답까지 시간</td><td>1.0</td></tr>
            <tr><td>Word Count</td><td>단어 수</td><td>5~20</td><td>발화 내 어절 수</td><td>1.0</td></tr>
            <tr><td>Vocabulary</td><td>TTR (Type-Token)</td><td>0.6~0.9</td><td>어휘 다양성</td><td>1.0</td></tr>
            <tr><td>Silence</td><td>무음 구간 (초)</td><td>0~1</td><td>발화 내 침묵 패턴</td><td>1.0</td></tr>
            <tr><td>Emotion</td><td>감정 안정성</td><td>70~100</td><td>감정 분석 기반 점수</td><td><strong>1.5</strong></td></tr>
            <tr><td>Vitality</td><td>VPR (발화/침묵)</td><td>2.0~10.0</td><td>활력도 (우울/무기력 지표)</td><td>1.0</td></tr>
        </tbody>
    </table>
    <p><strong>점수 계산 로직:</strong> 최적 범위 내 100점, 범위 미만 (실측/하한 x 100), 범위 초과 (100 - 초과분/상한 x 100). 감정 점수는 긍정 80~100, 중립 70~80, 부정 0~60. 종합 점수는 8개 차원의 가중 산술 평균입니다.</p>

    <h3>5.4 Q&A 데이터셋 + LLM 대화 <span class="badge badge-ai">GPT-4o-mini</span></h3>
    <ul>
        <li><strong>1단계 - Q&A 매칭</strong>: 10개 카테고리(인사, 약 복용, 식사, 건강, 감정, 날씨, 가족, 활동, 안전, 시간)의 50+ Q&A 쌍</li>
        <li><strong>3단계 매칭 로직</strong>: (1) 정확한 일치 -> (2) 부분 일치(포함 관계) -> (3) 키워드 일치(공통 단어 1개 이상)</li>
        <li><strong>2단계 - LLM 호출</strong>: GPT-4o-mini 감정 인식 대화 생성 (20대 손녀 '보미' 페르소나)</li>
        <li><strong>위험 감지</strong>: 평균 점수 < 50 또는 감정 점수 < 40 -> 고위험 프롬프트 자동 추가</li>
        <li><strong>대화 이력</strong>: 최대 10턴 유지, 시스템 프롬프트 실시간 업데이트</li>
    </ul>

    <h3>5.5 TTS 음성 합성 <span class="badge badge-ai">Edge TTS</span></h3>
    <ul>
        <li>기본 음성: ko-KR-SunHiNeural (밝고 친절한 여성 목소리)</li>
        <li>9종 한국어 음성 지원 (여성 5종 + 남성 4종)</li>
        <li>asyncio 기반 비동기 MP3 생성, rate 파라미터로 속도 조절</li>
    </ul>

    <h3>5.6 보호자 대시보드</h3>
    <ul>
        <li><strong>감정 현황</strong>: 최근 감정 분석 결과 및 감정 변화 추이 차트 (Chart.js)</li>
        <li><strong>활동량</strong>: 일간/주간/월간 움직임 감지 횟수 (모션 센서 기반)</li>
        <li><strong>인지 상태</strong>: 어휘 다양성, 반응 속도 등 인지 관련 지표</li>
        <li><strong>알림</strong>: 위험 상태 감지 실시간 알림 및 읽음 관리</li>
    </ul>

    <h3>5.7 사용자 관리 / 디바이스 관리</h3>
    <ul>
        <li>보호자 회원가입/로그인 (보호자 + 어르신 동시 등록)</li>
        <li>보호자/어르신 정보 수정, 비밀번호 변경</li>
        <li>IoT 디바이스 등록/관리, 센서 상태 확인</li>
        <li>음성 세션 생성 (sensing_id 발급)</li>
    </ul>

    <h3>5.8 알림 시스템</h3>
    <ul>
        <li>위험 감지 시 자동 알림 생성 (평균 점수 저하, 부정 감정 지속 등)</li>
        <li>미읽음 알림 실시간 확인 (/api/check-alert)</li>
        <li>알림 이력 목록 조회 (최근 10건) 및 일괄 읽음 처리</li>
    </ul>
</section>

<!-- SECTION 6 -->
<section id="sec6">
    <div class="section-header">
        <div class="section-num">6</div>
        <h2>화면 구성 (스크린샷)</h2>
    </div>

    <h3>6.1 늘봄 서비스 (9개 화면)</h3>

    <div class="screenshot-section">
        <div class="screenshot-group">
            <h4><span class="screen-num">1</span> 메인 랜딩 페이지 <span class="badge badge-public">Public</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_01_index.png" alt="메인 랜딩 페이지">
            <div class="screenshot-desc">
                <ul>
                    <li>"늘봄" 서비스 브랜딩 및 소개</li>
                    <li>AI 기반 노인 돌봄 음성 분석 시스템 설명</li>
                    <li>주요 기능 소개 및 "시작하기" CTA 버튼</li>
                </ul>
            </div>
        </div>

        <div class="screenshot-group">
            <h4><span class="screen-num">2</span> 로그인 페이지 <span class="badge badge-public">Public</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_02_login.png" alt="로그인 페이지">
            <div class="screenshot-desc">
                <ul>
                    <li>보호자 아이디/비밀번호 입력 폼</li>
                    <li>로그인 성공 시 대시보드 이동</li>
                    <li>회원가입 페이지 링크</li>
                </ul>
            </div>
        </div>

        <div class="screenshot-group">
            <h4><span class="screen-num">3</span> 회원가입 페이지 <span class="badge badge-public">Public</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_03_signup.png" alt="회원가입 페이지">
            <div class="screenshot-desc">
                <ul>
                    <li>보호자 정보 입력 (아이디, 비밀번호, 이름, 연락처, 주소)</li>
                    <li>어르신 정보 동시 등록 (이름, 생년월일, 성별, 거주형태, 관계)</li>
                    <li>Daum 우편번호 API 연동 주소 자동 입력</li>
                    <li>아이디 중복 확인, 음성 수집 동의</li>
                </ul>
            </div>
        </div>

        <div class="screenshot-group">
            <h4><span class="screen-num">4</span> 보호자 대시보드 <span class="badge badge-guardian">Guardian</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_04_dashboard.png" alt="보호자 대시보드">
            <div class="screenshot-desc">
                <ul>
                    <li>감정 현황 카드: 최근 감정 분석 결과 및 변화 추이</li>
                    <li>활동량 차트: 일간/주간/월간 움직임 감지 횟수</li>
                    <li>인지 상태 지표: 어휘 다양성, 반응 속도</li>
                    <li>알림 영역: 위험 상태 감지 알림</li>
                    <li>Chart.js 기반 데이터 시각화</li>
                </ul>
            </div>
        </div>

        <div class="screenshot-group">
            <h4><span class="screen-num">5</span> 보미 대화 (AI 음성 대화) <span class="badge badge-ai">AI Conversation</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_05_bomi.png" alt="보미 대화">
            <div class="screenshot-desc">
                <ul>
                    <li>어르신과 AI 대화 도우미 '보미'의 음성 대화 인터페이스</li>
                    <li>음성 녹음 버튼 -> 실시간 분석 진행 표시 (SSE)</li>
                    <li>STT 변환, 감정 분석, AI 응답, TTS 음성 출력 단계 표시</li>
                    <li>대화 이력 표시 및 감정 상태 시각화</li>
                </ul>
            </div>
        </div>

        <div class="screenshot-group">
            <h4><span class="screen-num">6</span> 건강 정보 <span class="badge badge-guardian">Guardian</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_06_health.png" alt="건강 정보">
            <div class="screenshot-desc">
                <ul>
                    <li>어르신 건강 상태 상세 조회</li>
                    <li>8차원 음성 분석 점수 시각화</li>
                    <li>감정 변화 추이 및 인지 기능 지표</li>
                </ul>
            </div>
        </div>

        <div class="screenshot-group">
            <h4><span class="screen-num">7</span> 리포트 <span class="badge badge-guardian">Guardian</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_07_report.png" alt="리포트">
            <div class="screenshot-desc">
                <ul>
                    <li>일간/주간/월간 분석 리포트</li>
                    <li>감정 분포 통계, 활동량 추이, 인지 기능 변화</li>
                    <li>종합 점수 트렌드 차트</li>
                </ul>
            </div>
        </div>

        <div class="screenshot-group">
            <h4><span class="screen-num">8</span> 마이페이지 <span class="badge badge-guardian">Guardian</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_08_mypage.png" alt="마이페이지">
            <div class="screenshot-desc">
                <ul>
                    <li>보호자 정보 수정 (이름, 연락처, 주소)</li>
                    <li>어르신 정보 수정 (이름, 생년월일, 거주형태)</li>
                    <li>비밀번호 변경</li>
                    <li>등록된 디바이스 정보 확인</li>
                </ul>
            </div>
        </div>

        <div class="screenshot-group">
            <h4><span class="screen-num">9</span> 디바이스 관리 <span class="badge badge-sensor">Device</span></h4>
            <img class="screenshot-img" src="../screenshot/neulbom_09_device.png" alt="디바이스 관리">
            <div class="screenshot-desc">
                <ul>
                    <li>IoT 디바이스 등록 및 목록 관리</li>
                    <li>센서 상태 확인 (motion/env/voice)</li>
                    <li>디바이스 설치 위치 및 시리얼 정보</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- SECTION 7 -->
<section id="sec7">
    <div class="section-header">
        <div class="section-num">7</div>
        <h2>API 설계</h2>
    </div>

    <h3>7.1 Flask 메인 API (21개)</h3>
    <table>
        <thead><tr><th>Method</th><th>Path</th><th>설명</th><th>인증</th></tr></thead>
        <tbody>
            <tr><td>GET</td><td><code>/</code></td><td>메인 페이지</td><td>-</td></tr>
            <tr><td>POST</td><td><code>/api/signup</code></td><td>보호자 회원가입 (보호자+어르신)</td><td>-</td></tr>
            <tr><td>POST</td><td><code>/api/login</code></td><td>보호자 로그인</td><td>-</td></tr>
            <tr><td>POST</td><td><code>/api/check-duplicate</code></td><td>아이디 중복 확인</td><td>-</td></tr>
            <tr><td>POST</td><td><code>/api/update-guardian</code></td><td>보호자 정보 수정</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>POST</td><td><code>/api/update-senior</code></td><td>어르신 정보 수정</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>POST</td><td><code>/api/change-password</code></td><td>비밀번호 변경</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>POST</td><td><code>/api/analyze</code></td><td>음성 파일 분석 (SSE 스트리밍)</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>GET</td><td><code>/api/voice-health</code></td><td>음성 분석 시스템 상태</td><td>-</td></tr>
            <tr><td>POST</td><td><code>/api/check-sensor</code></td><td>센서 존재 여부 확인</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>POST</td><td><code>/api/create-voice-session</code></td><td>음성 세션 생성</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>GET</td><td><code>/api/tts-audio/&lt;file&gt;</code></td><td>TTS 음성 파일 제공</td><td>-</td></tr>
            <tr><td>POST</td><td><code>/api/add-device</code></td><td>IoT 디바이스 등록</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>POST</td><td><code>/api/activity-daily</code></td><td>일간 활동량 조회</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>POST</td><td><code>/api/activity-weekly</code></td><td>주간 활동량 조회 (7일)</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>POST</td><td><code>/api/activity-monthly</code></td><td>월간 활동량 조회 (4주)</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>POST</td><td><code>/api/simulate-data</code></td><td>데이터 시뮬레이션 (테스트)</td><td><span class="badge badge-guardian">Guardian</span></td></tr>
            <tr><td>GET</td><td><code>/api/check-alert</code></td><td>실시간 알림 확인 (미읽음)</td><td>-</td></tr>
            <tr><td>POST</td><td><code>/api/alert-list</code></td><td>최근 알림 목록 (10건)</td><td>-</td></tr>
            <tr><td>POST</td><td><code>/api/alert-read-all</code></td><td>모든 알림 읽음 처리</td><td>-</td></tr>
        </tbody>
    </table>

    <h3>7.2 주요 API 상세: POST /api/analyze</h3>
    <p><strong>음성 분석</strong> 엔드포인트는 SSE(Server-Sent Events) 스트리밍으로 분석 진행 상태를 실시간 전송합니다.</p>
    <h4>요청 (multipart/form-data)</h4>
    <table>
        <thead><tr><th>필드</th><th>타입</th><th>설명</th></tr></thead>
        <tbody>
            <tr><td>audio_file</td><td>File</td><td>음성 파일 (필수)</td></tr>
            <tr><td>senior_id</td><td>Int</td><td>시니어 ID (기본값: 1)</td></tr>
            <tr><td>sensing_id</td><td>Int</td><td>센싱 ID (필수)</td></tr>
            <tr><td>generate_response</td><td>Bool</td><td>AI 응답 생성 여부 (기본: true)</td></tr>
        </tbody>
    </table>
    <h4>응답 (SSE Stream)</h4>
    <pre>step 1: 파일 저장 완료
step 2: STT 음성 인식 중...
step 3: STT 완료
step 4: 감정 분석: {감정} ({신뢰도}%)
step 5: AI 응답 생성 중...
step 5.5: 목소리 만드는 중...
step 5.7: TTS 완료
step 6: DB 저장 중...
step complete: 최종 결과 JSON</pre>
</section>

<!-- SECTION 8 -->
<section id="sec8">
    <div class="section-header">
        <div class="section-num">8</div>
        <h2>보안 설계</h2>
    </div>

    <h3>8.1 HTTPS 통신</h3>
    <table>
        <thead><tr><th>항목</th><th>구현 방식</th></tr></thead>
        <tbody>
            <tr><td><strong>SSL 인증서</strong></td><td>자체 서명(Self-signed) SSL 인증서 (PyOpenSSL, RSA 2048)</td></tr>
            <tr><td><strong>인증서 파일</strong></td><td>cert.pem, key.pem (generate_cert.py로 생성)</td></tr>
            <tr><td><strong>적용 대상</strong></td><td>Flask 서버 (:5000)</td></tr>
            <tr><td><strong>필요성</strong></td><td>브라우저 MediaRecorder API는 HTTPS 보안 컨텍스트 필수</td></tr>
        </tbody>
    </table>

    <h3>8.2 API 키 관리</h3>
    <table>
        <thead><tr><th>항목</th><th>구현 방식</th></tr></thead>
        <tbody>
            <tr><td><strong>대상</strong></td><td>OpenAI API 키</td></tr>
            <tr><td><strong>저장 위치</strong></td><td>api-key/openapi.env (소스코드 외부)</td></tr>
            <tr><td><strong>로딩</strong></td><td>python-dotenv -> os.getenv("OPENAI_API_KEY")</td></tr>
        </tbody>
    </table>

    <h3>8.3 세션 및 데이터베이스 보안</h3>
    <table>
        <thead><tr><th>항목</th><th>구현 방식</th></tr></thead>
        <tbody>
            <tr><td><strong>세션</strong></td><td>Flask secret_key, SameSite=None, Secure=True</td></tr>
            <tr><td><strong>CORS</strong></td><td>전체 허용 (개발 단계)</td></tr>
            <tr><td><strong>SQL Injection 방지</strong></td><td>파라미터 바인딩 (PreparedStatement)</td></tr>
            <tr><td><strong>트랜잭션</strong></td><td>저장 실패 시 rollback() 처리</td></tr>
            <tr><td><strong>비밀번호</strong></td><td>평문 저장 (향후 bcrypt 해싱 적용 예정)</td></tr>
        </tbody>
    </table>
</section>

<!-- SECTION 9 -->
<section id="sec9">
    <div class="section-header">
        <div class="section-num">9</div>
        <h2>배포 환경</h2>
    </div>

    <h3>9.1 서버 구성</h3>
    <table>
        <thead><tr><th>항목</th><th>내용</th></tr></thead>
        <tbody>
            <tr><td><strong>운영체제</strong></td><td>Windows</td></tr>
            <tr><td><strong>Python</strong></td><td>3.x (venv 가상환경)</td></tr>
            <tr><td><strong>GPU</strong></td><td>CUDA 지원 시 자동 활용 (torch.cuda)</td></tr>
            <tr><td><strong>메인 서버</strong></td><td>Flask (:5000) - bomi.py</td></tr>
            <tr><td><strong>대안 서버</strong></td><td>FastAPI (:8000) - server.py</td></tr>
            <tr><td><strong>데이터베이스</strong></td><td>MySQL (:3306) - 192.168.0.31 / care_db</td></tr>
        </tbody>
    </table>

    <h3>9.2 디렉토리 구조</h3>
    <pre>neulbomProject/
+-- bomi.py                     # Flask 메인 서버 (보호자 웹)
+-- server.py                   # FastAPI 분석 서버 (대안)
+-- analyzer.py                 # 음성 분석 엔진 (STT + 감정 + 점수)
+-- emotion_model.py            # 감정 앙상블 엔진 (KcELECTRA + Wav2Vec2)
+-- llm_handler_with_qa_v2.py   # LLM 핸들러 (Q&A 매칭 + GPT-4o-mini)
+-- db_handler.py               # DB 핸들러 (분석 결과 저장)
+-- tts_handler.py              # TTS 핸들러 (Edge TTS)
+-- qa_dataset_improved.py      # Q&A 데이터셋 (50+ 쌍)
+-- generate_cert.py            # SSL 인증서 생성
+-- config/                     # 설정 (모델, 점수, DB)
+-- templates/                  # Jinja2 템플릿 (9개 페이지)
+-- static/                     # 정적 파일 (JS, CSS, 이미지)
+-- api-key/                    # OpenAI API 키
+-- recordings/                 # 녹음 파일 저장
+-- tts_outputs/                # TTS 출력 파일 저장</pre>

    <h3>9.3 실행 방법</h3>
    <pre># 가상환경 활성화
.venv\Scripts\activate

# Flask 메인 서버 실행 (모델 자동 로드)
python bomi.py

# 또는 FastAPI 서버 실행
python server.py</pre>

    <p>서버 시작 시 다음 순서로 모델이 로드됩니다:</p>
    <ol>
        <li><strong>SpeechAnalyzer</strong> (Whisper + KcELECTRA + Wav2Vec2) - 약 2~3분 소요</li>
        <li><strong>LLMHandler</strong> (OpenAI API 연결)</li>
        <li><strong>VoiceDBHandler</strong> (MySQL 연결)</li>
        <li><strong>EdgeTTSHandler</strong> (TTS 초기화)</li>
    </ol>
</section>

<!-- SECTION 10 -->
<section id="sec10">
    <div class="section-header">
        <div class="section-num">10</div>
        <h2>프로젝트 성과</h2>
    </div>

    <h3>10.1 구현 결과</h3>
    <div class="card-grid">
        <div class="stat-card">
            <div class="stat-value">8</div>
            <div class="stat-label">음성 분석 차원</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">2</div>
            <div class="stat-label">감정 분석 모달리티 (텍스트+오디오)</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">6</div>
            <div class="stat-label">감정 클래스</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">50+</div>
            <div class="stat-label">Q&A 데이터셋</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">9</div>
            <div class="stat-label">프론트엔드 페이지</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">21</div>
            <div class="stat-label">API 엔드포인트</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">8</div>
            <div class="stat-label">DB 테이블</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">9</div>
            <div class="stat-label">TTS 음성 종류</div>
        </div>
    </div>

    <h3>10.2 주요 기술적 성과</h3>
    <div class="card">
        <ul>
            <li><strong>멀티모달 감정 앙상블 구현</strong>: 텍스트(KcELECTRA) + 오디오(Wav2Vec2) + Pitch Dynamics(Z-score)를 결합한 3중 앙상블 감정 분석으로 단일 모달리티 대비 정확성과 강건성 향상</li>
            <li><strong>8차원 종합 음성 분석 체계</strong>: Speed, Duration, Response, WordCount, Vocabulary, Silence, Emotion(x1.5), Vitality의 8가지 차원으로 어르신 상태를 다각적으로 평가하는 독자적 점수 체계 수립</li>
            <li><strong>Q&A + LLM 하이브리드 전략</strong>: 사전 정의 Q&A 우선 검색 + LLM 폴백으로 응답의 신뢰성과 유연성 동시 확보</li>
            <li><strong>실시간 SSE 스트리밍</strong>: 음성 분석 파이프라인의 각 단계(STT -> 감정 분석 -> AI 응답 -> TTS)를 실시간 표시하여 사용 경험 개선</li>
            <li><strong>통합 돌봄 플랫폼</strong>: 음성 분석, AI 대화, 센서 데이터, 대시보드, 알림을 하나의 웹 플랫폼으로 통합</li>
        </ul>
    </div>

    <h3>10.3 기술적 도전과 해결</h3>
    <table class="challenge-table">
        <thead><tr><th>도전</th><th>해결 방법</th></tr></thead>
        <tbody>
            <tr><td>단일 모달 감정 인식 한계</td><td>텍스트+오디오+Pitch 3중 앙상블로 정확도 향상</td></tr>
            <tr><td>어르신 음성 특성 반영</td><td>8차원 점수 체계로 다각적 평가 (감정 가중치 1.5배)</td></tr>
            <tr><td>LLM 응답 신뢰성</td><td>Q&A 데이터셋 우선 매칭 + LLM 폴백 2단계 전략</td></tr>
            <tr><td>분석 대기 시간</td><td>SSE 스트리밍으로 단계별 실시간 진행 표시</td></tr>
            <tr><td>HTTPS 필수 (녹음 API)</td><td>PyOpenSSL 자체 서명 인증서 자동 생성</td></tr>
            <tr><td>STT 속도 최적화</td><td>Whisper tiny + int8 양자화 + VAD 필터</td></tr>
        </tbody>
    </table>

    <h3>10.4 향후 개선 방향</h3>
    <table>
        <thead><tr><th>영역</th><th>개선 내용</th></tr></thead>
        <tbody>
            <tr><td><strong>보안 강화</strong></td><td>bcrypt 비밀번호 해싱, JWT 토큰 인증, 공인 SSL 인증서</td></tr>
            <tr><td><strong>AI 고도화</strong></td><td>Whisper small/medium 업그레이드, 노인 음성 Fine-tuning, 한국어 특화 LLM</td></tr>
            <tr><td><strong>기능 확장</strong></td><td>영상 통화 + 표정 분석, 약 복용 알림, 긴급 호출 시스템</td></tr>
            <tr><td><strong>인프라</strong></td><td>Docker 컨테이너화, 클라우드 배포, CI/CD 파이프라인</td></tr>
        </tbody>
    </table>
</section>

</div>

<!-- ========== FOOTER ========== -->
<div class="footer">
    <div class="brand">늘봄</div>
    <p>AI 기반 노인 돌봄 음성 분석 시스템</p>
    <p>"항상 봄처럼 따뜻한 돌봄"</p>
    <p style="margin-top: 10px; font-size: 0.8rem; color: #AAA;">2026-02-09 | 최종 결과 보고서</p>
</div>

</body>
</html>
